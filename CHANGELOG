Version ClaSS-0.8.20 release (2007/06/22)
-----------------------------------------

A new 'dif' marktype added to the mark table in preparation ofr the
new option.

Brought the install pages within the lang translations scheme - still
need to convert index.html and instal.php fully.

Started migrating all assessment related stuff to function calls; now
using update_assessment_scores() in both the MarkBook and ReportBook.

New table 'derivation' to be used for linking to dependent marks and
assessments.

The derivation field for an assessment can now be used to calculate
either SUM or AVE or RANK based on the scores of other assessments
identified by their element.

A suite of new functions in lib/fetch_assessment.php handle the
derivation of assessment scores. The update_assessment_score function
includes a call to check the derivation table and run an update of
derived assessments if neccessary.

New field added to the assessment table to flag the existence of
overall statistics exist for that assessment.

Two new httpscripts in the ReportBook, accessed as a rowaction button
from the new_assessments page. So, calculate_assessment_statistics
stores both an overall stage average for every bid-pid in the eidsid
table with sid=0 for and individual cross-curricular sid averages with
bid='G'; it generates a a new eid for each stage to do this. Also,
calculate_assessment_rank is available when an assessment is created
using the derivation RANK(element) and it generates student ranks
based on their score for the assessment identified by element. Neither
the ranks nor averages are dynamic, they need ot be updated using the
button as required.

Improved the algorithm for how fetchReports calls to fetchAssessments.

Now generalised the checksidsAction javascript function to be used in
any context, passing whatever parameters are listed in the embedded xml.

Added a new button to the edit_reports page, and the neccessary check
boxes, which uses checksidsAction to print simple summaries of student
reports for just the bid of the current class. Uses a new template
called subject_report_summary.

Fixed fetchSubjectReports so combining reports with contrary numbers of
assessments does not ommit any.

Bugfix to a typo in checkcurrentRespon in permissions, it was
over-looking subject responsibilities.


Version ClaSS-0.8.19 release (2007/05/31)
-----------------------------------------

Minor bugfix to edit_scores to make cancel button work - sub_action() was
not being called.

Tweaked the #ddd dull grey background colour to be less dull.

New scripts in the infobook and a new div on the student_view page to
display and edit enrolment properties of a student. Will also show the
history of their application in future. A new fetchEnrolment()
function added which is specicifically for this purpose and no other.

The enrolments and accomodation pages in the Admin book both now make
use of the new community_list scripts. Which should become general
purpose for listing sids and editing in any type of community in
future. These now allow click-throughs from the table of numbers to
the list of students relating to that position on the
accomodation/enrolment table. Enrolment fully working. Only partially
implemented for accomodation so far.

The access to enrolment communities through yeargroup_edit has now
been deprecated because of the above.

Two new css classes (hilife and lowlife).

Any sids not on current roll and listed in InfoBook are now
de-emphasised using the lowlife class.

New onchange js function for checkboxes in listmenus which
de-emphasises/emphasises the table row based on its checked status.

Made the event handlers for the checkrowIndicator part of loadRequired
and standardised the trId to have a "sid-" prefix to be consistent
with the sidtable functions.


Version ClaSS-0.8.18 release (2007/05/25)
-----------------------------------------

Consistently renamed the set_XXX vars scripts.

New functions to list_courses and list_course_stages.

In the Admin book, renamed the logcounter page and added a new option
to call from it which gives overall statistics for the current
academic year. Working towards more in depth stats.

Locked down the permissions in the InfoBook a little further. For role
of 'support' and 'office' there is no access to the comments, incidents
or tracking. Also 'support' can only view and not edit.

A new field for the list_vars called filter. This can be used for enum
fields to limit their values to just the enum values which exist in
the database table named by $listfilter. Has been implemented for the
InfoBook search fields.

Migrated list_stage.php over to use list_vars.

Included some ad hoc stuff to calculate overall totals for the Admin
book's accomodation page.

Hooked in set_accomodation to the editing of student details from the
InfoBook.

The search for accomodation communities temporarily(!) lists all students
who have ever belonged regardless of start and end date.

Revealed the capacity as a new column on the yeargroup_matrix for
admin and office roles.


Version ClaSS-0.8.17 release (2007/05/11)
-----------------------------------------

The ugly redirect.php script has finally been updated to call
script/set_action_post_vars.php and include only those vars for
posting which are listed by the parent page in the array
$action_post_vars.

Bug-fix to column_copy.php in the MarkBook when copying grades.

Renamed new_mark2 and new_mark_action to be consistent with other
action scripts; now new_mark_action1 and new_mark_action2
respectively.

Removed the dead and unused scripts column_hide.php and column_show.php.

Expanded the xmlarray capabilities to allow for a default_value, this
is set by xmlarray_form() when the field value is empty.

Have working first versions of the admin pages for enrolments and
accomodation. These use coutin_community to show a spreadsheet of the
student numbers subscribed.


Version ClaSS-0.8.16 release (2007/05/07)
-----------------------------------------

Use patch-0.8.16.sql to bring the db into line with the changes!

The student firstlanguage field has been brought in to line with CBDS
2007, renamed language and allows a char4 code. This is accompanied by
the addition of the languagetype field. Maintains compatibility by
maintaing the old firstlanguage codes in the language list but these
should be deprecated.

All nationality and country fields (in tables guardian, student, and
address) are moved to char2 and now use the iso codes. The patch which
updates the database will curtail entries to their first two letters
and, be warned, this may lose you data! It is straightforward to check the
nationailities you have against there relevant iso code and add some
entries to the patch to convert them in advance of the change
(examples are included).

Added new field companyname to the guardian table and exposed both
this and the profession fields through the Contact array.

The transportmode field has been included as part of the Student
array. While the transportroute field has been dropped from the info
table and will be superceded by membership of the communities for
school buses.

Attempted to solve a problem with the selct fields in the bookoptions;
options of different lengths also had different css widths and made
clicking difficult. Have had to use fixed widths in px to get around
this, as nothing else worked. Firefox rendering css problem?

Have added a new contact option and associated scripts to the
EntryBook. This still needs tying in with a new student though.

Incorporated selerySwitch into the js to allow selerylabel fields to
switch the input fields the user sees. Used first as part of the
contact search options.

Completed the set of html_functions with a new list_select_enum().
 
The entrybook session variables now use the book_session_variables
script.

A new field "capacity" (or maximum size) added to the community table
to limit available places for enrolments.

Simplified the yeargroup_edit screen (as the "students already in"
column was redundant).

A new enrolments_matrix.php option added to the Admin book. Available
only to admin and office roles, this is work in progress.

The academic year has been added to the Entrybook sideoptions for use
when entering students into the enrolments process.

Migrated both the list scripts for year and enrolment_status over to use
the new list_select functions.

Changed the naming of the communities during the enrolments procedure.
New fields year and season have been added to the community table to
allow enrolments to work with different academic sessions. The
prospective year of entry is the same as the curriculum year (though
strictly this is tied to a course!). The prospective yeargroup for
enrolment is recorded as part of the name of the community. NOTE they
are only subscribed to a yeargroup community once they join the
current roll, yeargroup and form communities only exist for the
current cohort and so their year/season fields remain empty.

Added option of a local lang file which sits outside of the class
application path. Create schoollang.php in the toplevel directory to
have any string customised for the school (as opposed to the
language).

Incorporated a button to unlink a contact from a student as part of
contact_details.php. The contact remains in the database.

Both the EntryBook and InfoBook pages for contact details have been
given a select field as part of the action buttons which pulls an
existing contact record from the database and allows it to be linked
to the student. Have made the relationship a required field.

A new table for accomodation and an eccompanying section of the
student profile has been added. This allows the managment of details
for boarders including their arrival and departure times. A student is
subscribed to a new type of community 'accomodation' which is named
based on their gender and accomodation category with memebership
linked to the dates of the stay.

The sequence of pages in the EntryBook has been changed to incorporate
giving a new student both a boarder stay (if boarder set on first
page) and a first contact (second contact needs adding?).

A crude new script in the Admin book to give a snapshot of the class
sizes for a course.

Temporary fix to the display of community names; now can use the
detail field if it is not null. And displays the year for the
enrolment communities.



Version ClaSS-0.8.15 release (2007/04/16)
-----------------------------------------

Exposed the nationality field for the guardians.

Incorporated a choice of contactfield for searching in the
quick_search.php which defaults to surname.

Added the ISO two letter country codes, these are translated in the
countries.php file which is part of each lang pack. These still need
to be implemented for the nationality and country fields.

Office and admin roles can now search in the infobook using a choice
of fields for both contact and student. The fields can be extended.


Version ClaSS-0.8.14 release (2007/04/02)
-----------------------------------------

The use of listvariables for list_community.php had broken the cohort
matrix. Had to bugfix by making selectedvalue for arrays to be
correctly handled.

Also the import_students dob was broken. This needs to be made clever.


Version ClaSS-0.8.13 release (2007/03/30)
-----------------------------------------

Standardised on an externalparams array for constructing the link in
all the externalbooks.

New field added to table users to hold the emailpasswd and used to feed
to the external webmail app (use the patch!!!). This is encrypted
before storing in the db using endecrypt taken from moodlelib. The
same function is needed at the other end (in the webmail app) to
decrypt the password upon receipt.

The xmlprocessor function is under development for publishing reports
to files. The feature is currently an admin only button for the
report_reports_list.php page. It needs a new (and temporary!)
toplevel directory called reports to publish the html files in, one
per student. Set the $CFG->html2ps path and you'll very slowly get pdf
too.

Added hostfamily as a valid value for the boarder field and a list of
additional categories to the enrolment status field. Both additions
are outside the CBDS.

Exapanded the communties available for enrolment, and added matching
entries to enrolmentstatus in the info table (patch
needed!!!). Reworked yeargroup_edit pages to work with these.

The join_community function changed to take account of the extra
enrolment possibilities and the previous generic enquired:enquired,
aplied:applied and accepted:accepted:accepted communitites are now
superceded. The patch will update them to read accepted:AC etc.

New feature is student export in the InfoBook as an action
button for the student_list - needs choice of fields adding.

The db tables form and tidcid both had the old varchar(10) for
teacher_id, now corrected in the new patch.

Made list_community.php compatible with listoptions.

Reorganised the infobook search scripts and added the option to search
any community for office and admin users.

Adopted phpmailer library for handling email. This needs instructions
added to the install. It is called only from send_email_to(), a new
function adapted from Moodle to handle attachments. Requires new
config settings for email in school.php, including optional smtp options.

Bugfix to book_variables.php which was missing the get value for cancel.

First crude implementation of searching for contacts in the
InfoBook. This has added contact_list.php as the main page for the
results and some changes to contact_details.php to work when no sid is
selected.

The contacts can now call on fetchDependents() function to list the
contents of the gidsid table. Although its an xml-array Dependents
does not fit with the rest of the Student xml logic and will remain
localised to the contacts pages of the InfoBook.

Made the lists for yeargroup, form, academic group printable by adding
viewcontent ids.


Version ClaSS-0.8.12 release (2007/03/15)
-----------------------------------------

The rowaction buttons are now generated using a library call to
html_functions, uses the same extrabuttons function as the other
buttonmenus.

Updated the medium.xsl report template to use summary elements.

Added portfolio_accounts to the Admin book - in a state of heavy
development and not ready for use yet.

Fixed up the ents_list form in the InfoBook.

Version ClaSS-0.8.11 release (2007/03/12)
-----------------------------------------

Added a logout call for the eportfolio to the js logout function.

Added eportfolio_db_prefix to the school.php config options to bring
into line with how these often implement shared databases.

Bugfix to the new http/report_reports_print.php which was not getting
the transform right. This is now passed through the imbedded
xml-check-action div in the report_reports_list.php page.


Version ClaSS-0.8.10 release (2007/02/28)
-----------------------------------------

A third rating of 'general' added to the comments.

Removed the length limit for incident details.

Added a pastoralemailfooter to lang/en/class.php which is used by both
incidents and comments.

New options added to school.php. $CFG->emailoff disables sending all
emails to staff (only the administrator user's email address will be
active). $CFG->emailcomments will notify responsibile staff by email
of new commments, in the same way that incidents are already
posted. Incidents can now be turned off with $CFG->emailincidents.

Bugfix to the EntryBook which solves new students with enrolstatus of
'enquired' not joining their community group.

Finally working with cohorts in the ReportBook. Using lisinCohort and
listinCommunity for matching students to academic and pastoral responsibilities
respectively when it comes to collating subject reports or whatever.

Added a sitestatus div which is swapped in and out with sitelogo to
provide a progress or activity indicator in the bottom left
corner. Controlled by javascript progressIndicator(). Used during
xmlHttp requests - could be used for messages too?

Have moved the "Preview selected" form buttons over to use an xmlHttp
request instead of a page reload. New javascript function
checksidsAction grabs the sids from the checked boxes and makes a call
to reportbook/httpscripts report_reports_print.php.

openPrintReport() can now take the xml directly passed as a third term
as well as grabbing it from a hidden div in the page to allow for
above.

Removed the redundant code in column_edit.php for linking marks to
assessments.

Implement cohorts to filter for relevance in list_assessments.

Cleaned up the naming of cohort, community and permissions functions
to be consistent with the rudimentary conventions described in the
head of functions.php.

fetchAssessments can no take an eid as an optional value to return all
results for just that one assessment (before it returned ALL results).

The report_assessments scripts now work with cohorts and consequently
can handle assessments across multiple courses correctly
side-by-side. The recoding has increased the speed of this slug
hugely; it is now actually useful!

Added $book sensitivity to the extrabuttons functions so they can have
their description in the book lang files instead of all in class.php.

Improved list_stage and list_assessment so they can filter for rbid as
well as rcrid responsibilities.

Implemented sencurriculum to allow per subject statements of need, the
current statements are maintained as a starting 'General' subject. New
category field added to the sencurriculum table to flag for type of
extra support provided - this also needs new 'sen' types in the
categorydef table loaded. The database field sentype changed from an
enum to a char(3). This all needs patch-0.8.10.sql to be applied!

Updating to match CBDS changes, SEN NationalCurriculum is now
NCmodifications.

Started to standardise the list_scripts to use the same named
variables and then a function call to list_select().

Bugfix for the comment.xsl templates.

Version ClaSS-0.8.9 release (2007/01/30)
----------------------------------------

Corrected all varchar(250) fields in the infobook tables to be plain text
fields - needs patch-0.8.9.sql!

In bookfunctions.js, makeLabel was not being used to prepare the
xmltag by fillxmlTable but it is now.

Added second contact options to the student display fields in the InfoBook.

Bugfixes to the import_stats and new_stats pages in the ReportBook.


Version ClaSS-0.8.8 release (2007/01/22)
----------------------------------------

The loginaside text had gone missing - it needed the
loadBookOptions("logbook") to be called at the end of login.php.

Have renamed fputcsv to be file_putcsv as it conflicts with the stock
fputcsv function in PHP5.

Version ClaSS-0.8.7 release (2007/01/19)
----------------------------------------

A bugfix to the register which fixes the completion list. It was
failing to exclude students who had left a registration group. The
leavingdate clause has been added to the check_CommunityAttendance
function.

Tracked down missing D grades in the ReportBook to scoreToGrade()
function mistaking grades with score value zero for null strings.
Now use is_numeric for scoreToGrade() and scoreToPercent().

Added Element and Derivation to the new_assessments form.

Renamed xmlpreparer to be xmlechoer and now using xmlpreparer to
return xml for use by xslt_process.

Added phonenumber to the info table and fixed the length of the email
field to 240 - needs patch-0.8.7.sql.

Use phonenumber field for 'MobilePhone' in the Student xml fields.

Email, MobilePhone and FirstContact all added to the studentfields 
displaying from the select lists in the InfoBook student list.

The padding of the span element used by qtip was causing a problem for
onhover and has bee replaced by giving the span just the width and
height of its contents - it must now have a content or qtip!

The find_sids script has a problem with matching three letter
names. Best for now is to pull out results for an exact match. But its
only a work round not a solution.

Version ClaSS-0.8.6 release (2007/01/03)
----------------------------------------

A bugfix to the register to allow the display of a fresh attendance
event even correctly. Achieved with a simplification of the code by
adding the fresh event to the end of the existing AttendanceEvents.

Version ClaSS-0.8.5 release (2006/12/20)
----------------------------------------

Added a timezone setting to $CFG and included in classdata to set for
all pages. Really only needed by the Register when the school's
timezone differs form the servers.

Bug fix to responables page. The pastoral buttons needed their
rowaction container to work.

Moving towards using listCommunties function in both admin and
register, to list all communities of one type.

Added completion_list to the register to list the status of
registration groups for the current event. This also uses a new xsl
template to print the registers.

To allow xsl printing within the register the events have been given
an AttendanceEvent xmlarray.
 
Added simple nav buttons to the register_list to move back in time one
week at a time.

Version ClaSS-0.8.4 release (2006/12/16)
----------------------------------------

Now made the book_session_variables script available to host pages to
handle post and get for vars that maintain state between reloads. It
doesn't do anything extra upon var change so is currently only used in
the seneeds book.

Filtering the student_list in seneeds book by sentype, yeargroup, and
sen review date now implemented as part of the sideoptions.

Added checkeveid to the session vars in the Register, it now maintains
the selected column.

Version ClaSS-0.8.3 release (2006/12/12)
----------------------------------------

Bug-fix to list_report_wrappers, the requiredor form elements need to
be arrays if named the same or a blank value can be passed.

Moved formfunctions to bookfunctions and userinterface to hostfunctions.
Moved viewstyle to bookstyle and parentstyle to hoststyle.

Basic absence lists added to the register.

Bug-fix to eliminate multiple assessments cells being printed. Now
uses the assessment element to check they only exist once.

Added requiredor class to the javascript validation for eitheror
fields. Implemented in the reportbook to start with.

Changed MarkBook table colours to match the other books.

Cosmetic changes to the marktable including addition of a shortcut
link for student_view.

Moved out the page variables from each of the book host pages to
scripts/book_variables.php.

Reorganised the infobook search to allow onsidechange for the groups.

Version ClaSS-0.8.2 release (2006/11/30)
----------------------------------------

First working version of the register completed. Now records
absent or present status; when present lateness; when absent a absence code.

Added create_register to the install process
which creates two new tables, event and attendance.

New javascript extension to the UI added for highlighting selected
table columns and student rows. Currently only implemented in the
register. Uses a css class "selected".

The css of the sideoptions has been cleaned up with a new class selery.

Moved commentdate to a default value in commentDisplay and moved to
using mktime to do the claculation.
 
Removed the unused date variable from the User class.

Have dropped the nicetitles code in favour of the neater leaner
qTip. This means all the popup title attributes are now moved out to
span elements. All much tidier.

Added to the css and html_functions tp provide a new "selery" class
which replaces the ugly select elements on the sideoptions. Requires
two lines of javascript to work and part of the userinterface code.

Increased the length of the email field in the guardian table.

Added js for font resizing using a third sidebutton in the logbook.


Version ClaSS-0.8.1 release (2006/11/09)
---------------------------------------------------- 

Changed password to pin for the staff_details form, added list_role,
and used list_book for the firstbookpref.

Changed naming of teacher id and staff number in the entrybook.

Moved the setting of $tab=1 into the head_options.

A statement of intent, adding library, medical, and sen to the array
of user roles - even though they don't yet do anything.

Removed the limitation of needing all books enabled for the 'admin'
role by adding a non-role to the the books array called 'all'. This now
takes care of telling index.php about pre-loading all viewbooks. 

Added SENeeds book which displays just sids flagged with SEN='Y'. Uses
a new getSENPerm to allow access for pastoral and sen responsibles to
change the sen records.

Now check for admin role in report_reports and for users with more
than one pastoral responsibility.

Fixed bug in list_student_reports which caused no reports to be
displayed, and added selections for individual course reports as well
as report wrappers.
