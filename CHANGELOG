Version ClaSS-0.8.16 release (2007/04/23)
-----------------------------------------

Use patch-0.8.16.sql to bring the db into line with the changes!

The student firstlanguage field has been brought in to line with CBDS
2007, renamed language and allows a char4 code. This is accompanied by
the addition of the languagetype field. Maintains compatibility by
maintaing the old firstlanguage codes in the language list but these
should be deprecated.

All nationality fields (in tables guardian and student) are moved to
char2 and now use the iso codes.

Added new field companyname to the guardian table and exposed both
this and the profession fields through the Contact array.

The transportmode field has been included as part of the Student
array. While the transportroute field has been dropped from the info
table and will be superceded by membership of the communities for
school buses.

Attempted to solve a problem with the selct fields in the bookoptions;
optins of different lengths also had different css widths and made
clicking difficult. Have had to use fixed widths in px to get around
this, as nothing else worked. Firefox rendering css problem?

Have added a new contact option and associated scripts to the
EntryBook. This still needs tying in with a new student though.

Incorporated selerySwitch into the js to allow selerylabel fields to
switch the input fields the user sees. Used first as part of the
contact search options.

Completed the set of html_functions with a new list_select_enum().
 
The entrybook session variables now use the book_seesion_variables
script.

A new field "capacity" (or maximum size) added to the community table
to limit available places for enrolments.

Simplified the yeargroup_edit screen (as the students already in
column was redundant).

A new enrolments_matrix.php option added to the Admin book. Available
only to admin and office roles, this is work in progress.

The academic year has been added to the Entrybook sideoptions for use
when entering students into the enrolments process.

Migrated both the list scripts for year and enrolment_status over to use
the new list_select functions.

Changed the naming of the communities for enrolments to include the
curriculum year of entry (although strictly the curriculum year is
tied to the course!). The prospective yeargroup for enrolment is
recorded in the student table under yeargroup_id BUT they are not
subscribed to any yeargroup related community only their enrolment
community until they join the current roll.


Version ClaSS-0.8.15 release (2007/04/16)
-----------------------------------------

Exposed the nationality field for the guardians.

Incorporated a choice of contactfield for searching in the
quick_search.php which defaults to surname.

Added the ISO two letter country codes, these are translated in the
countries.php file which is part of each lang pack. These still need
to be implemented for the nationality and country fields.

Office and admin roles can now search in the infobook using a choice
of fields for both contact and student. The fields can be extended.


Version ClaSS-0.8.14 release (2007/04/02)
-----------------------------------------

The use of listvariables for list_community.php had broken the cohort
matrix. Had to bugfix by making selectedvalue for arrays to be
correctly handled.

Also the import_students dob was broken. This needs to be made clever.


Version ClaSS-0.8.13 release (2007/03/30)
-----------------------------------------

Standardised on an externalparams array for constructing the link in
all the externalbooks.

New field added to table users to hold the emailpasswd and used to feed
to the external webmail app (use the patch!!!). This is encrypted
before storing in the db using endecrypt taken from moodlelib. The
same function is needed at the other end (in the webmail app) to
decrypt the password upon receipt.

The xmlprocessor function is under development for publishing reports
to files. The feature is currently an admin only button for the
report_reports_list.php page. It needs a new (and temporary!)
toplevel directory called reports to publish the html files in, one
per student. Set the $CFG->html2ps path and you'll very slowly get pdf
too.

Added hostfamily as a valid value for the boarder field and a list of
additional categories to the enrolment status field. Both additions
are outside the CBDS.

Exapanded the communties available for enrolment, and added matching
entries to enrolmentstatus in the info table (patch
needed!!!). Reworked yeargroup_edit pages to work with these.

The join_community function changed to take account of the extra
enrolment possibilities and the previous generic enquired:enquired,
aplied:applied and accepted:accepted:accepted communitites are now
superceded. The patch will update them to read accepted:AC etc.

New feature is student export in the InfoBook as an action
button for the student_list - needs choice of fields adding.

The db tables form and tidcid both had the old varchar(10) for
teacher_id, now corrected in the new patch.

Made list_community.php compatible with listoptions.

Reorganised the infobook search scripts and added the option to search
any community for office and admin users.

Adopted phpmailer library for handling email. This needs instructions
added to the install. It is called only from send_email_to(), a new
function adapted from Moodle to handle attachments. Requires new
config settings for email in school.php, including optional smtp options.

Bugfix to book_variables.php which was missing the get value for cancel.

First crude implementation of searching for contacts in the
InfoBook. This has added contact_list.php as the main page for the
results and some changes to contact_details.php to work when no sid is
selected.

The contacts can now call on fetchDependents() function to list the
contents of the gidsid table. Although its an xml-array Dependents
does not fit with the rest of the Student xml logic and will remain
localised to the contacts pages of the InfoBook.

Made the lists for yeargroup, form, academic group printable by adding
viewcontent ids.


Version ClaSS-0.8.12 release (2007/03/15)
-----------------------------------------

The rowaction buttons are now generated using a library call to
html_functions, uses the same extrabuttons function as the other
buttonmenus.

Updated the medium.xsl report template to use summary elements.

Added portfolio_accounts to the Admin book - in a state of heavy
development and not ready for use yet.

Fixed up the ents_list form in the InfoBook.

Version ClaSS-0.8.11 release (2007/03/12)
-----------------------------------------

Added a logout call for the eportfolio to the js logout function.

Added eportfolio_db_prefix to the school.php config options to bring
into line with how these often implement shared databases.

Bugfix to the new http/report_reports_print.php which was not getting
the transform right. This is now passed through the imbedded
xml-check-action div in the report_reports_list.php page.


Version ClaSS-0.8.10 release (2007/02/28)
-----------------------------------------

A third rating of 'general' added to the comments.

Removed the length limit for incident details.

Added a pastoralemailfooter to lang/en/class.php which is used by both
incidents and comments.

New options added to school.php. $CFG->emailoff disables sending all
emails to staff (only the administrator user's email address will be
active). $CFG->emailcomments will notify responsibile staff by email
of new commments, in the same way that incidents are already
posted. Incidents can now be turned off with $CFG->emailincidents.

Bugfix to the EntryBook which solves new students with enrolstatus of
'enquired' not joining their community group.

Finally working with cohorts in the ReportBook. Using lisinCohort and
listinCommunity for matching students to academic and pastoral responsibilities
respectively when it comes to collating subject reports or whatever.

Added a sitestatus div which is swapped in and out with sitelogo to
provide a progress or activity indicator in the bottom left
corner. Controlled by javascript progressIndicator(). Used during
xmlHttp requests - could be used for messages too?

Have moved the "Preview selected" form buttons over to use an xmlHttp
request instead of a page reload. New javascript function
checksidsAction grabs the sids from the checked boxes and makes a call
to reportbook/httpscripts report_reports_print.php.

openPrintReport() can now take the xml directly passed as a third term
as well as grabbing it from a hidden div in the page to allow for
above.

Removed the redundant code in column_edit.php for linking marks to
assessments.

Implement cohorts to filter for relevance in list_assessments.

Cleaned up the naming of cohort, community and permissions functions
to be consistent with the rudimentary conventions described in the
head of functions.php.

fetchAssessments can no take an eid as an optional value to return all
results for just that one assessment (before it returned ALL results).

The report_assessments scripts now work with cohorts and consequently
can handle assessments across multiple courses correctly
side-by-side. The recoding has increased the speed of this slug
hugely; it is now actually useful!

Added $book sensitivity to the extrabuttons functions so they can have
their description in the book lang files instead of all in class.php.

Improved list_stage and list_assessment so they can filter for rbid as
well as rcrid responsibilities.

Implemented sencurriculum to allow per subject statements of need, the
current statements are maintained as a starting 'General' subject. New
category field added to the sencurriculum table to flag for type of
extra support provided - this also needs new 'sen' types in the
categorydef table loaded. The database field sentype changed from an
enum to a char(3). This all needs patch-0.8.10.sql to be applied!

Updating to match CBDS changes, SEN NationalCurriculum is now
NCmodifications.

Started to standardise the list_scripts to use the same named
variables and then a function call to list_select().

Bugfix for the comment.xsl templates.

Version ClaSS-0.8.9 release (2007/01/30)
----------------------------------------

Corrected all varchar(250) fields in the infobook tables to be plain text
fields - needs patch-0.8.9.sql!

In bookfunctions.js, makeLabel was not being used to prepare the
xmltag by fillxmlTable but it is now.

Added second contact options to the student display fields in the InfoBook.

Bugfixes to the import_stats and new_stats pages in the ReportBook.


Version ClaSS-0.8.8 release (2007/01/22)
----------------------------------------

The loginaside text had gone missing - it needed the
loadBookOptions("logbook") to be called at the end of login.php.

Have renamed fputcsv to be file_putcsv as it conflicts with the stock
fputcsv function in PHP5.

Version ClaSS-0.8.7 release (2007/01/19)
----------------------------------------

A bugfix to the register which fixes the completion list. It was
failing to exclude students who had left a registration group. The
leavingdate clause has been added to the check_CommunityAttendance
function.

Tracked down missing D grades in the ReportBook to scoreToGrade()
function mistaking grades with score value zero for null strings.
Now use is_numeric for scoreToGrade() and scoreToPercent().

Added Element and Derivation to the new_assessments form.

Renamed xmlpreparer to be xmlechoer and now using xmlpreparer to
return xml for use by xslt_process.

Added phonenumber to the info table and fixed the length of the email
field to 240 - needs patch-0.8.7.sql.

Use phonenumber field for 'MobilePhone' in the Student xml fields.

Email, MobilePhone and FirstContact all added to the studentfields 
displaying from the select lists in the InfoBook student list.

The padding of the span element used by qtip was causing a problem for
onhover and has bee replaced by giving the span just the width and
height of its contents - it must now have a content or qtip!

The find_sids script has a problem with matching three letter
names. Best for now is to pull out results for an exact match. But its
only a work round not a solution.

Version ClaSS-0.8.6 release (2007/01/03)
----------------------------------------

A bugfix to the register to allow the display of a fresh attendance
event even correctly. Achieved with a simplification of the code by
adding the fresh event to the end of the existing AttendanceEvents.

Version ClaSS-0.8.5 release (2006/12/20)
----------------------------------------

Added a timezone setting to $CFG and included in classdata to set for
all pages. Really only needed by the Register when the school's
timezone differs form the servers.

Bug fix to responables page. The pastoral buttons needed their
rowaction container to work.

Moving towards using listCommunties function in both admin and
register, to list all communities of one type.

Added completion_list to the register to list the status of
registration groups for the current event. This also uses a new xsl
template to print the registers.

To allow xsl printing within the register the events have been given
an AttendanceEvent xmlarray.
 
Added simple nav buttons to the register_list to move back in time one
week at a time.

Version ClaSS-0.8.4 release (2006/12/16)
----------------------------------------

Now made the book_session_variables script available to host pages to
handle post and get for vars that maintain state between reloads. It
doesn't do anything extra upon var change so is currently only used in
the seneeds book.

Filtering the student_list in seneeds book by sentype, yeargroup, and
sen review date now implemented as part of the sideoptions.

Added checkeveid to the session vars in the Register, it now maintains
the selected column.

Version ClaSS-0.8.3 release (2006/12/12)
----------------------------------------

Bug-fix to list_report_wrappers, the requiredor form elements need to
be arrays if named the same or a blank value can be passed.

Moved formfunctions to bookfunctions and userinterface to hostfunctions.
Moved viewstyle to bookstyle and parentstyle to hoststyle.

Basic absence lists added to the register.

Bug-fix to eliminate multiple assessments cells being printed. Now
uses the assessment element to check they only exist once.

Added requiredor class to the javascript validation for eitheror
fields. Implemented in the reportbook to start with.

Changed MarkBook table colours to match the other books.

Cosmetic changes to the marktable including addition of a shortcut
link for student_view.

Moved out the page variables from each of the book host pages to
scripts/book_variables.php.

Reorganised the infobook search to allow onsidechange for the groups.

Version ClaSS-0.8.2 release (2006/11/30)
----------------------------------------

First working version of the register completed. Now records
absent or present status; when present lateness; when absent a absence code.

Added create_register to the install process
which creates two new tables, event and attendance.

New javascript extension to the UI added for highlighting selected
table columns and student rows. Currently only implemented in the
register. Uses a css class "selected".

The css of the sideoptions has been cleaned up with a new class selery.

Moved commentdate to a default value in commentDisplay and moved to
using mktime to do the claculation.
 
Removed the unused date variable from the User class.

Have dropped the nicetitles code in favour of the neater leaner
qTip. This means all the popup title attributes are now moved out to
span elements. All much tidier.

Added to the css and html_functions tp provide a new "selery" class
which replaces the ugly select elements on the sideoptions. Requires
two lines of javascript to work and part of the userinterface code.

Increased the length of the email field in the guardian table.

Added js for font resizing using a third sidebutton in the logbook.


Version ClaSS-0.8.1 release (2006/11/09)
---------------------------------------------------- 

Changed password to pin for the staff_details form, added list_role,
and used list_book for the firstbookpref.

Changed naming of teacher id and staff number in the entrybook.

Moved the setting of $tab=1 into the head_options.

A statement of intent, adding library, medical, and sen to the array
of user roles - even though they don't yet do anything.

Removed the limitation of needing all books enabled for the 'admin'
role by adding a non-role to the the books array called 'all'. This now
takes care of telling index.php about pre-loading all viewbooks. 

Added SENeeds book which displays just sids flagged with SEN='Y'. Uses
a new getSENPerm to allow access for pastoral and sen responsibles to
change the sen records.

Now check for admin role in report_reports and for users with more
than one pastoral responsibility.

Fixed bug in list_student_reports which caused no reports to be
displayed, and added selections for individual course reports as well
as report wrappers.
